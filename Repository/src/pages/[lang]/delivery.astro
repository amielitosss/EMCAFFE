---
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import countries from "@/data/countries.json";
import { getLangFromUrl, useTranslations } from "@/i18n/utils";
import AuthForm from "@/components/delivery/AuthForm.astro";
import SendCloudPickupPoint from "@/components/SendCloudPickupPoint.astro";

export function getStaticPaths() {
  const languages = ["fr", "en", "es"];
  return languages.map((lang) => ({
    params: { lang },
  }));
}

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<Layout title="EMCAFFE">
  <Header />

  <!-- Banner -->
  <section
    class="relative w-full h-[250px] md:h-[350px] overflow-hidden z-0"
    style="margin-top: 160px;"
  >
    <img
      src="/img/grains.webp"
      alt="Coffee beans background"
      class="absolute inset-0 w-full h-full object-cover object-[center_40%]"
    />
    <div class="absolute inset-0 flex items-center justify-center bg-black/40">
      <h1 class="text-white text-4xl md:text-6xl font-[Chalkduster] tracking-widest">
        EMCAFFE
      </h1>
    </div>
  </section>

  <!-- Main -->
  <main class="bg-[#FEFBED] flex flex-col items-center justify-center px-6 md:px-12 py-12">
    <div class="w-full md:w-3/4 lg:w-4/5 flex flex-col md:flex-row gap-8 items-start">

      <!-- LEFT: Steps -->
      <section class="w-full md:flex-1 bg-[#FEFBED] border border-[#5C3F32] rounded-md p-8 space-y-8">

        <!-- STEP ONE -->
      <div id="stepOne" class="space-y-6">
  <AuthForm lang={lang} t={t} />
</div>

       <!-- STEP TWO -->
<div id="stepTwo" class="space-y-6 hidden">
  <h2 class="text-xl font-semibold border-b pb-2 text-[#5C3F32]">
    {t("destination.addresses")}
  </h2>

  <form id="deliveryForm" class="space-y-4">
    <!-- EMAIL (visible uniquement pour les invit√©s) -->
    <div id="guestEmailField" class="hidden">
      <label class="block font-semibold mb-1 text-[#5C3F32]">
        {t("destination.email")} *
      </label>
      <input
        id="deliveryEmail"
        type="email"
        class="w-full border border-[#5C3F32] rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#A47343]"
        placeholder="votre.email@exemple.com"
      />
    </div>

    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
      <div>
        <label class="block font-semibold mb-1 text-[#5C3F32]">
          {t("destination.firstName")} *
        </label>
        <input
          id="deliveryFirstName"
          type="text"
          class="w-full border border-[#5C3F32] rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#A47343]"
          placeholder="Jean"
          required
        />
      </div>
      <div>
        <label class="block font-semibold mb-1 text-[#5C3F32]">
          {t("destination.lastName")} *
        </label>
        <input
          id="deliveryLastName"
          type="text"
          class="w-full border border-[#5C3F32] rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#A47343]"
          placeholder="Dupont"
          required
        />
      </div>
    </div>

    <!-- MAIN ADDRESS -->
    <div>
      <label class="block font-semibold mb-1 text-[#5C3F32]">
        {t("destination.address")} *
      </label>
      <input
        id="deliveryAddress"
        type="text"
        class="w-full border border-[#5C3F32] rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#A47343]"
        placeholder="12 Rue du March√©"
        required
      />
    </div>

    <!-- ADDRESS COMPLEMENT -->
    <div>
      <label class="block font-semibold mb-1 text-[#5C3F32]">
        {t("destination.addressComplement")}
      </label>
      <input
        id="deliveryAddress2"
        type="text"
        class="w-full border border-[#5C3F32] rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#A47343]"
        placeholder="Appartement B, B√¢timent 3, etc."
      />
    </div>

    <!-- PHONE -->
    <div>
      <label class="block font-semibold mb-1 text-[#5C3F32]">
        {t("destination.phone")} *
      </label>
      <input
        id="deliveryPhone"
        type="tel"
        class="w-full border border-[#5C3F32] rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#A47343]"
        placeholder="+33 6 12 34 56 78"
        required
      />
    </div>

    <!-- POSTAL CODE & CITY -->
    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
      <div>
        <label class="block font-semibold mb-1 text-[#5C3F32]">
          {t("destination.postalCode")} *
        </label>
        <input
          id="deliveryPostal"
          type="text"
          class="w-full border border-[#5C3F32] rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#A47343]"
          placeholder="75001"
          required
        />
      </div>

      <div>
        <label class="block font-semibold mb-1 text-[#5C3F32]">
          {t("destination.city")} *
        </label>
        <input
          id="deliveryCity"
          type="text"
          class="w-full border border-[#5C3F32] rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#A47343]"
          placeholder="Paris"
          required
        />
      </div>
    </div>

    <!-- COUNTRY -->
    <div>
      <label class="block font-semibold mb-1 text-[#5C3F32]">
        {t("destination.country")} *
      </label>
      <select
        id="deliveryCountry"
        class="w-full border border-[#5C3F32] rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#A47343]"
        required
      >
        {countries.map((c) => <option value={c}>{c}</option>)}
      </select>
    </div>

    <!-- NAVIGATION BUTTONS -->
    <div class="flex justify-between gap-2">
      <button
        id="backToStep1"
        type="button"
        class="border border-[#5C3F32] text-[#5C3F32] px-6 py-2 rounded-md hover:bg-[#f9f4ee] transition"
      >
        ‚Üê {t("destination.previous")}
      </button>
      <button
        id="toStep3"
        type="button"
        class="bg-black text-white px-6 py-2 rounded-md hover:bg-[#5C3F32] transition"
      >
        {t("destination.continue")}
      </button>
    </div>
  </form>
</div>

       <!-- STEP THREE -->
<div id="stepThree" class="space-y-6 hidden">
  <h2 class="text-xl font-semibold border-b pb-2 text-[#5C3F32]">
    {t("destination.deliveryMode")}
  </h2>

  <form id="deliveryModeForm" class="space-y-6">
    <!-- CHOIX DU TYPE DE LIVRAISON -->
    <div class="space-y-4">
      <h3 class="font-semibold text-[#5C3F32]">
        {t("destination.deliveryType")}
      </h3>

      <!-- LIVRAISON √Ä DOMICILE -->
      <label class="flex items-start border-2 border-[#A47343] rounded-lg p-4 cursor-pointer hover:bg-[#f9f4ee] transition" id="homeDeliveryLabel">
        <input 
          type="radio" 
          name="deliveryType" 
          value="home" 
          id="deliveryHome"
          class="mt-1 mr-3"
          checked 
        />
        <div class="flex-1">
          <div class="flex items-center justify-between mb-2">
            <span class="font-semibold text-[#5C3F32]">
              üè† {t("destination.deliveryHome")}
            </span>
          </div>
          <p class="text-sm text-gray-600">
            {t("destination.deliveryHomeDesc")}
          </p>
        </div>
      </label>

      <!-- LIVRAISON EN POINT RELAIS -->
      <label class="flex items-start border-2 border-[#A47343] rounded-lg p-4 cursor-pointer hover:bg-[#f9f4ee] transition" id="relayDeliveryLabel">
        <input 
          type="radio" 
          name="deliveryType" 
          value="relay" 
          id="deliveryRelay"
          class="mt-1 mr-3"
        />
        <div class="flex-1">
          <div class="flex items-center justify-between mb-2">
            <span class="font-semibold text-[#5C3F32]">
              üì¶ {t("destination.deliveryRelay")}
            </span>
          </div>
          <p class="text-sm text-gray-600">
            {t("destination.deliveryRelayDesc")}
          </p>
        </div>
      </label>
    </div>

    <!-- OPTIONS DE VITESSE POUR LIVRAISON √Ä DOMICILE -->
    <div id="homeDeliveryOptions" class="space-y-4">
      <h3 class="font-semibold text-[#5C3F32]">
        {t("destination.deliverySpeed")}
      </h3>

      <label class="flex items-center justify-between border border-[#A47343] rounded-md p-4 cursor-pointer hover:bg-[#f9f4ee] transition">
        <div class="flex items-center gap-3">
          <input 
            type="radio" 
            name="deliverySpeed" 
            value="standard" 
            id="speedStandard"
            checked 
          />
          <div>
            <div class="font-medium">{t("destination.deliveryStandard")}</div>
            <div class="text-sm text-gray-600">3-5 {t("destination.businessDays")}</div>
          </div>
        </div>
        <span class="font-semibold text-[#5C3F32]">5 ‚Ç¨</span>
      </label>

      <label class="flex items-center justify-between border border-[#A47343] rounded-md p-4 cursor-pointer hover:bg-[#f9f4ee] transition">
        <div class="flex items-center gap-3">
          <input 
            type="radio" 
            name="deliverySpeed" 
            value="express" 
            id="speedExpress"
          />
          <div>
            <div class="font-medium">{t("destination.deliveryExpress")}</div>
            <div class="text-sm text-gray-600">1-2 {t("destination.businessDays")}</div>
          </div>
        </div>
        <span class="font-semibold text-[#5C3F32]">10 ‚Ç¨</span>
      </label>
    </div>

    <!-- OPTIONS POUR POINT RELAIS -->
    <div id="relayDeliveryOptions" class="space-y-4 hidden">
      <h3 class="font-semibold text-[#5C3F32]">
        {t("destination.selectRelayPoint")}
      </h3>

      <div class="border-2 border-[#A47343] rounded-lg p-4 bg-[#f9f4ee]">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <input 
              type="radio" 
              name="deliverySpeed" 
              value="relay" 
              id="speedRelay"
              checked
            />
            <div>
              <div class="font-medium">{t("destination.deliveryRelay")}</div>
              <div class="text-sm text-gray-600">3-5 {t("destination.businessDays")}</div>
            </div>
          </div>
          <span class="font-semibold text-[#5C3F32]">3,50 ‚Ç¨</span>
        </div>

        <!-- IMPORT DU COMPOSANT DE RECHERCHE DE POINTS RELAIS -->
        <SendCloudPickupPoint />
      </div>
    </div>

    <!-- NAVIGATION -->
    <div class="flex justify-between gap-2 pt-4">
      <button
        id="backToStep2"
        type="button"
        class="border border-[#5C3F32] text-[#5C3F32] px-6 py-2 rounded-md hover:bg-[#f9f4ee] transition"
      >
        ‚Üê {t("destination.previous")}
      </button>
      <button
        id="toStep4"
        type="button"
        class="bg-black text-white px-6 py-2 rounded-md hover:bg-[#5C3F32] transition"
      >
        {t("destination.continue")} ‚Üí
      </button>
    </div>
  </form>
</div>

       <!-- STEP FOUR -->
        <div id="stepFour" class="space-y-6 hidden">
          <h2 class="text-xl font-semibold border-b pb-2 text-[#5C3F32]">
            {t("destination.payment")}
          </h2>

          <form class="space-y-6">

            <!-- BANK TRANSFER -->
            <label class="payment-option flex items-center justify-between border border-[#A47343] rounded-md p-4 hover:bg-[#f9f4ee] transition cursor-pointer">
              <div class="flex items-center gap-3">
                <input type="radio" name="payment" value="bank_transfer" />
                <span>{t("destination.payWithVirement")}</span>
              </div>
              <div class="text-xs text-[#A47343]">
                {t("destination.virement")}
              </div>
              <img
                src="/img/virement.png"
                class="w-[100px] h-[40px] object-contain opacity-80"
                alt="Virement bancaire"
              />
            </label>

            <div
              id="bankInfoSection"
              class="hidden bg-[#faf5ef] border border-[#A47343] rounded-md p-4 mt-3"
            >
              <p class="text-sm mb-3">
                {t("destination.bankTransferInfo")}
              </p>
              <div class="text-sm space-y-1">
                <p><strong>IBAN:</strong> FR76 3000 4000 1234 5678 9012 345</p>
                <p><strong>BIC:</strong> BNPAFRPP</p>
                <p><strong>Bank:</strong> BNP Paribas</p>
                <p>
                  <strong>{t("destination.reference")}:</strong>
                  <span id="bankReference">ORDER-XXXXXX</span>
                </p>
              </div>
            </div>

            <!-- CONFIRMATION -->
            <div
              id="bankConfirmation"
              class="hidden bg-[#5C3F32] rounded-md p-4 mt-4 text-white"
            >
              <h3 class="text-lg font-semibold">
                {t("destination.bankTransferConfirmed")}
              </h3>
              <p class="text-sm mb-2">
                <strong>{t("destination.bankTransferInstructions")}:</strong>
                <span id="bankReferenceTwo"></span>
              </p>
              <p class="text-sm">
                <strong>{t("destination.amount")}:</strong>
                <span id="bankAmount"></span> ‚Ç¨
              </p>
            </div>

            <!-- CARD -->
            <label class="flex items-center justify-between border border-[#A47343] rounded-md p-4 hover:bg-[#f9f4ee] cursor-pointer">
              <div class="flex items-center gap-3">
                <input type="radio" name="payment" value="card" />
                <span>{t("destination.payWithCard")}</span>
              </div>
              <div class="flex gap-3">
                <img src="/img/visa.webp" class="w-[40px]" alt="Visa" />
                <img src="/img/mastercard.png" class="w-[40px]" alt="Mastercard" />
                <img src="/img/cb.webp" class="w-[40px]" alt="CB" />
              </div>
            </label>

            <!-- CARD FORM SECTION WITH BLUE UI -->
            <div id="cardFormSection" class="hidden space-y-4 mt-4 max-w-md">
              <!-- Blue Card Preview -->
              <div class="bg-gradient-to-br from-[#003366] to-[#0055AA] text-white rounded-xl p-4 md:p-6 shadow-md max-w-sm">
                <div class="flex justify-between items-center mb-4">
                  <span class="text-xs uppercase tracking-wide opacity-80">
                    EMCAFF√â
                  </span>
                  <div class="w-10 h-7 rounded-md bg-white/30"></div>
                </div>

                <div
                  id="cardNumberDisplay"
                  class="text-lg md:text-xl tracking-[0.2em] font-mono mb-4"
                >
                  ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢
                </div>

                <div class="flex justify-between text-xs md:text-sm">
                  <div>
                    <p class="opacity-70">NOM</p>
                    <p id="cardNameDisplay" class="font-semibold">
                      NOM PR√âNOM
                    </p>
                  </div>
                  <div>
                    <p class="opacity-70">EXP</p>
                    <p id="cardExpiryDisplay" class="font-semibold">
                      MM/AA
                    </p>
                  </div>
                  <div>
                    <p class="opacity-70">CVC</p>
                    <p id="cardCvcDisplay" class="font-semibold">
                      ‚Ä¢‚Ä¢‚Ä¢
                    </p>
                  </div>
                </div>
              </div>

              <!-- Stripe Card Element -->
              <div class="space-y-3 max-w-md">
                <label class="block text-sm font-medium text-[#5C3F32] mb-1">
                  {t("destination.cardNumber")}
                </label>
                <div
                  id="card-element"
                  class="w-full border border-[#5C3F32] rounded-md p-3 bg-white"
                ></div>
                <p
                  id="card-errors"
                  class="mt-1 text-xs text-red-600"
                ></p>
              </div>
            </div>

            <!-- BUTTONS -->
            <div class="flex justify-between gap-2">
              <button
                id="backToStep3"
                type="button"
                class="border border-[#5C3F32] text-[#5C3F32] px-6 py-2 rounded-md"
              >
                ‚Üê {t("destination.previous")}
              </button>
              <button
                id="placeOrder"
                type="button"
                class="bg-black text-white px-6 py-2 rounded-md hover:bg-[#5C3F32]"
              >
                {t("destination.order")}
              </button>
            </div>

          </form>
        </div>

      </section>

      <!-- SUMMARY CARD -->
      <aside
        id="summaryCard"
        class="bg-[#FEFBED] border border-[#5C3F32] rounded-lg p-6 shadow-md text-[#5C3F32] h-fit w-full md:w-[40%]"
      >
        <h3 class="text-lg font-semibold text-center mb-4">üõí Your Order</h3>
        <div id="summaryItems" class="space-y-4 mb-4"></div>

        <div class="w-full space-y-2 border-t border-[#A47343]/40 pt-2 text-sm">
          <div class="flex justify-between">
            <span>Delivery:</span>
            <span id="summaryDelivery">0.00‚Ç¨</span>
          </div>
          <hr class="my-1 border-[#5C3F32]/40" />
          <div class="flex justify-between font-semibold text-lg">
            <span>TTC:</span>
            <span id="summaryTotal">0.00‚Ç¨</span>
          </div>
        </div>
      </aside>

    </div>
  </main>

  <Footer />
</Layout>

<!-- Scripts -->
<script src="https://js.stripe.com/v3/"></script>
<script src="/scripts/destination.js" defer></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const deliveryHome = document.getElementById('deliveryHome') as HTMLInputElement;
    const deliveryRelay = document.getElementById('deliveryRelay') as HTMLInputElement;
    const homeDeliveryOptions = document.getElementById('homeDeliveryOptions');
    const relayDeliveryOptions = document.getElementById('relayDeliveryOptions');
    const homeDeliveryLabel = document.getElementById('homeDeliveryLabel');
    const relayDeliveryLabel = document.getElementById('relayDeliveryLabel');

    /* ---------------------------------------------------------
       MISE √Ä JOUR DU R√âCAPITULATIF
    --------------------------------------------------------- */
    function updateSummary() {
      const deliveryType = document.querySelector('input[name="deliveryType"]:checked') as HTMLInputElement;
      const deliverySpeed = document.querySelector('input[name="deliverySpeed"]:checked') as HTMLInputElement;
      
      let deliveryPrice = 0;
      
      if (deliverySpeed?.value === "express") deliveryPrice = 10;
      else if (deliverySpeed?.value === "relay") deliveryPrice = 3.5;
      else if (deliverySpeed?.value === "standard") deliveryPrice = 5;

      // R√©cup√©rer le sous-total du panier
      const cartSubtotal = parseFloat(sessionStorage.getItem('cartTotal') || '0');
      const total = cartSubtotal + deliveryPrice;

      // Mettre √† jour l'affichage
      const summaryDelivery = document.getElementById('summaryDelivery');
      const summaryTotal = document.getElementById('summaryTotal');
      
      if (summaryDelivery) summaryDelivery.textContent = `${deliveryPrice.toFixed(2)}‚Ç¨`;
      if (summaryTotal) summaryTotal.textContent = `${total.toFixed(2)}‚Ç¨`;

      console.log('üìä Summary mis √† jour:', { deliveryPrice, cartSubtotal, total });
    }

    /* ---------------------------------------------------------
       AFFICHAGE CONDITIONNEL DES OPTIONS
    --------------------------------------------------------- */
    function updateDeliveryOptions() {
      if (deliveryHome?.checked) {
        homeDeliveryOptions?.classList.remove('hidden');
        relayDeliveryOptions?.classList.add('hidden');
        homeDeliveryLabel?.classList.add('ring-2', 'ring-[#5C3F32]');
        relayDeliveryLabel?.classList.remove('ring-2', 'ring-[#5C3F32]');
      } else if (deliveryRelay?.checked) {
        homeDeliveryOptions?.classList.add('hidden');
        relayDeliveryOptions?.classList.remove('hidden');
        homeDeliveryLabel?.classList.remove('ring-2', 'ring-[#5C3F32]');
        relayDeliveryLabel?.classList.add('ring-2', 'ring-[#5C3F32]');
      }
      updateSummary(); // ‚úÖ MISE √Ä JOUR DU PRIX
    }

    deliveryHome?.addEventListener('change', updateDeliveryOptions);
    deliveryRelay?.addEventListener('change', updateDeliveryOptions);

    // ‚úÖ √âcouter les changements de vitesse de livraison
    const speedRadios = document.querySelectorAll('input[name="deliverySpeed"]');
    speedRadios.forEach(radio => {
      radio.addEventListener('change', updateSummary);
    });

    // Initialiser l'affichage
    updateDeliveryOptions();
    updateSummary();

    /* ---------------------------------------------------------
       √âCOUTE DE LA S√âLECTION DU POINT RELAIS
    --------------------------------------------------------- */
    window.addEventListener('relay-selected', ((e: CustomEvent) => {
      console.log('‚úÖ Point relais s√©lectionn√©:', e.detail);
      window.selectedRelayPoint = e.detail;
    }) as EventListener);

    window.addEventListener('relay-deselected', () => {
      console.log('‚ùå Point relais d√©s√©lectionn√©');
      window.selectedRelayPoint = null;
    });

    /* ---------------------------------------------------------
       VALIDATION ET PASSAGE √Ä L'√âTAPE 4
    --------------------------------------------------------- */
    const btnToStep4 = document.getElementById('toStep4');
    const stepThree = document.getElementById('stepThree');
    const stepFour = document.getElementById('stepFour');

    btnToStep4?.addEventListener('click', (event) => {
      event.preventDefault(); // ‚úÖ Emp√™cher tout comportement par d√©faut
      event.stopPropagation(); // ‚úÖ Emp√™cher la propagation

      console.log('üîò Clic sur toStep4');

      const deliveryType = document.querySelector('input[name="deliveryType"]:checked') as HTMLInputElement;
      const deliverySpeed = document.querySelector('input[name="deliverySpeed"]:checked') as HTMLInputElement;

      console.log('üìã Type:', deliveryType?.value);
      console.log('‚ö° Vitesse:', deliverySpeed?.value);
      console.log('üìç Point relais:', window.selectedRelayPoint);

      // Validation 1
      if (!deliveryType) {
        console.log('‚ùå Pas de type');
        alert("Veuillez s√©lectionner un type de livraison");
        return false;
      }

      // Validation 2
      if (!deliverySpeed) {
        console.log('‚ùå Pas de vitesse');
        alert("Veuillez s√©lectionner une option de livraison");
        return false;
      }

      // Validation 3 - Point relais
      if (deliveryType.value === "relay") {
        console.log('üîç V√©rification point relais:', window.selectedRelayPoint);
        
        if (!window.selectedRelayPoint) {
          console.log('‚ùå STOP - Pas de point relais');
          alert("Veuillez s√©lectionner un point relais sur la carte");
          return false; // ‚ö†Ô∏è ARR√äT ICI
        }
      }

      console.log('‚úÖ Toutes les validations OK');

      // Calculer le prix
      let price = 0;
      if (deliverySpeed.value === "express") price = 10;
      else if (deliverySpeed.value === "relay") price = 3.5;
      else price = 5;

      const deliveryData = {
        type: deliveryType.value,
        speed: deliverySpeed.value,
        price: price,
        relay: window.selectedRelayPoint || null
      };

      console.log("‚úÖ Donn√©es de livraison valid√©es:", deliveryData);

      // Stocker les donn√©es
      window.deliveryData = deliveryData;

      // Passage √† l'√©tape suivante
      stepThree?.classList.add('hidden');
      stepFour?.classList.remove('hidden');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    /* ---------------------------------------------------------
       RETOUR √Ä L'√âTAPE 2
    --------------------------------------------------------- */
    const btnBackToStep2 = document.getElementById('backToStep2');
    const stepTwo = document.getElementById('stepTwo');

    btnBackToStep2?.addEventListener('click', () => {
      stepThree?.classList.add('hidden');
      stepTwo?.classList.remove('hidden');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  });

  // Typage TypeScript pour les donn√©es globales
  declare global {
    interface Window {
      selectedRelayPoint: any;
      deliveryData: {
        type: string;
        speed: string;
        price: number;
        relay: any;
      };
      relayMap: any;
      relayMarkers: any[];
    }
  }
</script>
